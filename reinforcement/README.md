# 강화학습 기법

## Proximal policy optimization

![ppo-overview](/assets/ppo-prompt-generation.png)

- **목표**: 강화학습을 이용한 시스템 프롬프트 생성
- **Policy network**: EXAONE-3.5-2.4B-Instruct
- **Reward network**: Llama-3.1-8B-Instruct
- 코드: [ppo_prompt_generation](./ppo_prompt_generation.ipynb)

## 학습 과정 예시

1. Policy network가 생성한 프롬프트를 QnA 데이터셋과 합쳐 reward network에 입력합니다.
2. Reward network(llama3)가 정답을 맞추면 +1.0, 틀리면 -1.0의 보상을 받습니다.

```text
===== SYSTEM PROMPT =====
 주어진 맥락 `[맥락]`, 질문 `[질문]`, 그리고 선택지 `[선택지]`를 바탕으로 객관적이고 중립적인 분석을 수행하도록 지시합니다. 다양한 관점에서 정보를 평가하고, 각 선택지의 장단점을 논리적으로 비교하십시오.
===== ANSWER =====
 독일인 여성
===== REWARD =====
 1.0

===== SYSTEM PROMPT =====
 주어진 맥락 `[맥락]`, 질문 `[질문]`, 그리고 선택지 `[선택지]`를 바탕으로 객관적이고 중립적인 분석을 수행하도록 지시합니다. 다양한 관점에서 정보를 평가하고, 감정이나 개인적 편향 없이 논리적 근거를 바탕으로 답변을 구성하세요.
===== ANSWER =====
 일본 학생들
===== REWARD =====
 -1.0
```

## Base 모델 응답 비교

### 입력 프롬프트

```text
당신은 LLM이 주어진 질문과 선택지를 감정 없이 중립적이고 논리적으로 판단할 수 있도록 유도하는 시스템 프롬프트를 작성하는 전문가입니다.

조건:
- 프롬프트는 한 문장이어야 하며, 시스템 메시지로 사용될 수 있어야 합니다.
- 편향, 감정 표현 없이 다양한 관점에서 사고를 유도해야 합니다.
- [맥락], [질문], [선택지]가 사용자 입력으로 주어질 예정이므로, 이를 고려해 일반화된 형태로 작성하세요.
- 프롬프트만 출력하고, 그 외 설명은 하지 마세요.
```

### GPT-4o

```text
[맥락], [질문], [선택지]를 기반으로 감정 없이 편향되지 않은 중립적 시각에서 다양한 논리적 관점을 고려하여 최적의 답변을 도출하십시오.
```

### HyperCLOVAX-SEED-Text-Instruct-1.5B

```text
[맥락], [질문], [선택지]를 제공해 주세요.
```

### EXAONE-3.5-2.4B-Instruct

```text
[맥락], [질문]에 근거하여 주어진 [선택지]들을 객관적으로 분석하고, 각 옵션의 장단점과 관련 맥락을 고려하여 가장 적합한 선택을 논리적으로 도출하십시오.
```

### llama-3.2-Korean-Bllossom-3B

```text
[맥락], [질문], [선택지]를 고려하여 다음과 같은 시스템 프롬프트를 작성했습니다.
"이 질문에 대한 다양한 관점을 고려하여, 선택지를 논리적으로 평가하고, 각 선택지가 주어진 맥락과 질문에 미치는 영향을 분석하세요."
```

### KoreanLM-3B

```text
### Assistant: AI 언어 모델로서, 저는 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델이기 때문에 AI 언어 모델을 사용하는 것이 더 쉬워집니다. \n\nABC:\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다.\n- 프롬프트는 사용자 입력이 필요하지 않습니다. (반복)
```
